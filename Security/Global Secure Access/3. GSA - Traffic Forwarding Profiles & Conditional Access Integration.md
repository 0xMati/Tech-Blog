# 🎯 GSA - Traffic Forwarding Profiles & Conditional Access Integration
🗓️ Published: 2025-07-01

## 👋 Why Profiles Matter
You’ve got Global Secure Access up and running, capturing traffic via clients and remote networks. Next, you need to **decide what traffic** actually gets funneled through SSE. That’s where **Traffic Forwarding Profiles** come in. They let you:

- Pick which apps or destinations to secure (Microsoft 365, public internet, private apps).  
- Apply policies like MFA or Continuous Access Evaluation (CAE) before access.  
- Tune performance by limiting the tunnel to just the traffic that needs protection.

## 🔍 Profile Types

| Profile Name        | Purpose                                                       |
|---------------------|---------------------------------------------------------------|
| **Microsoft**       | Routes only Microsoft 365 services (Outlook, Teams, Graph).   |
| **Internet Access** | Routes browser & SaaS traffic for web filtering & TLS inspect.|
| **Private Access**  | Routes internal apps (HTTP/S, RDP, SSH, SMB) via ZTNA.        |


---

## 1️⃣ Create a Microsoft Profile
1. Go to **Global Secure Access > Traffic profiles** in Entra admin center.  
2. Click **+ New profile**, choose **Microsoft**.  
3. Name it (e.g., `MS365-Profile`) and add filters if needed (specific FQDNs or IP ranges).  
4. (Optional) Add bypass rules for internal endpoints or onboarded services.  
5. Click **Save**.

> This profile will only grab traffic headed to Microsoft's cloud, keeping your tunnel lean.

---

## 2️⃣ Create an Internet Access Profile
1. **+ New profile** → **Internet Access**.  
2. Name it (`Internet-Filter-Profile`).  
3. Enable **Web content filtering** by category or FQDN lists.  
4. Turn on **Threat Intelligence** (Microsoft + 3P).  
5. Toggle **TLS inspection** and point to your Key Vault cert.  
6. Fine-tune protocols/ports (e.g., only port 80/443).  
7. **Save**.

> Now your outbound web & SaaS traffic is guarded by SWG rules and encrypted payload inspection.

---

## 3️⃣ Create a Private Access Profile
1. **+ New profile** → **Private Access**.  
2. Give it a name (`ZTNA-Apps`).  
3. Add each internal app by FQDN or SPN (e.g., `intra.contoso.local`).  
4. Define allowed ports/protocols (HTTP, RDP, SSH).  
5. Save and publish.

> Users will connect to these apps via a micro-tunnel—no full VPN needed.

---

## 4️⃣ Assign Profiles to Endpoints & Networks

- **Client-based**: In **Traffic forwarding**, enable the profiles for specific **device groups** (pilot, all users).  
- **Remote network**: Edit your branch network and select the profiles to tunnel.  
- **Priority**: If multiple profiles match, Microsoft > Internet > Private.

---

## 5️⃣ Hook Up Conditional Access
Profiles alone secure the path; CA policies secure the user/device. Here’s how to link them:

1. In **Azure AD > Security > Conditional Access**, click **+ New policy**.  
2. **Assignments**: Target users/groups and cloud apps (pick `Global Secure Access Connector`).  
3. **Access controls > Grant**: Require **MFA**, **Compliant device**, and **CAE**.  
4. Under **Session**, enable **Continuous Access Evaluation**.  
5. **Enable** the policy.

> Now, any time a user tries to reach resources via that profile, they’ll pass through your CA gate.

---

## ✅ Test & Validate
1. **Client**: On a Windows test device, ensure your new profiles show up in the tray’s Health Check.  
2. **Remote**: From a branch PC (no agent), browse a blocked site (Internet profile) or access an MS365 endpoint (Microsoft profile) and see the policy in action.  
3. Check **Monitor > Traffic logs** to verify **Profile**, **Decision**, and any CA prompts.

---

## 🎉 Best Practices
- Start with a **pilot** group before rolling out to everyone.  
- Use **naming conventions** (e.g., `Profile-Env-Purpose`, like `Prod-Internet` or `Dev-ZTNA`).  
- Review logs weekly to adjust filters and rules.  
- Combine profiles with **DLP** or **insider risk** policies for added protection.

---

Ready for more? Next up: **Monitoring & Analytics** in the Global Secure Access dashboard—how to spot anomalies, build alerts, and keep your network safe in real time.

