# Dangerous ACLs expose GPOs applied to privileged group members (attack path)
üóìÔ∏è Published: 2025-05-06


# üß± 1. Introduction

## What is a control path in Active Directory

A control path in Active Directory refers to a sequence of permissions that allows a user or group to gain control over a target object, either directly or indirectly, by chaining access rights across multiple objects.
In simpler terms, it‚Äôs the ‚Äúpath‚Äù that an attacker could follow‚Äîvia delegated permissions, misconfigured ACLs, or inherited rights‚Äîto escalate privileges or compromise critical AD components.
Control paths are typically built using:
- Access Control Entries (ACEs) that allow rights like GenericAll, WriteDacl, WriteOwner, or AllExtendedRights.
- Object relationships, such as Group Membership, OU delegation, or GPO application.
- Privilege boundaries not being respected (e.g., standard users controlling GPOs linked to Domain Admins).

These paths are often non-obvious and span multiple AD layers. A user might not have direct rights over a Domain Admin account, but might control a GPO applied to it, or be able to modify an object that eventually affects it.

![](assets/Dangerous%20ACLs%20expose%20GPOs%20applied%20to%20privileged%20group%20members%20(attack%20path)/2025-05-06-22-53-21.png)

This diagram illustrates a privilege escalation control path in Active Directory:

- UserA has GenericWrite rights on Group1, allowing them to modify its membership.
- Group1 is a member of GPOE2, so UserA indirectly gains influence over GPOE2.
- GPOE2 has GPOEdit rights on GPO_Admins, meaning its members can edit the GPO.
- GPO_Admins is applied to the Domain Admins OU ‚Äî any changes to this GPO affect Domain Admins.
‚û°Ô∏è Result: UserA can escalate privileges and potentially compromise Domain Admins via this chain of misconfigured permissions.

## Why misconfigured ACLs are dangerous

Access Control Lists (ACLs) in Active Directory define who can interact with directory objects and what actions they can perform ‚Äî from reading attributes to modifying group memberships or delegating control.
When ACLs are misconfigured, they can unintentionally grant users or groups privileged access over critical objects such as:
- Group Policy Objects (GPOs)
- Organizational Units (OUs)
- Security groups (including Domain Admins)
- User or computer accounts

This creates opportunities for privilege escalation, persistence mechanisms, and even full domain compromise. Attackers often exploit these weaknesses post-compromise, using tools like BloodHound to identify and follow control paths that stem from over-permissive ACLs.

Even a single ACE (Access Control Entry) granting GenericAll, WriteDACL, or GenericWrite on a sensitive object can be the starting point of a complete Active Directory takeover.
ACLs are especially dangerous when:
- Inheritance is enabled inappropriately.
- Legacy delegation models are still in place.
- Groups like Authenticated Users or Domain Users are granted write permissions to privileged objects.

## Typical exploitation context: post-compromise attacks, persistence, privilege escalation.

Once an attacker has initial access in an Active Directory environment ‚Äî often as a low-privileged user ‚Äî they will look for misconfigured ACLs to move laterally or escalate privileges.
Here are common scenarios:
- üß¨ GPO Hijacking: An attacker with edit rights on a GPO applied to privileged users can deploy malicious logon scripts or scheduled tasks to execute code with elevated privileges.
- üîÅ Group Membership Manipulation: With GenericWrite or WriteMembers rights over a group, an attacker can add themselves to a group that is indirectly linked to high privileges.
- üîì WriteDACL Abuse: The ability to modify an object‚Äôs ACL allows the attacker to grant themselves full control (GenericAll), effectively owning the object.
- üß± OU Delegation Abuse: Poorly delegated permissions at the OU level can expose multiple child objects (users, groups, computers) to compromise.

These attack techniques are not theoretical ‚Äî they have been observed in real-world breaches, and often form the core of post-exploitation playbooks using tools like BloodHound, PowerView, or ADExplorer.

# üîç 2. Root Cause of the Vulnerability

This article specifically focuses on a critical misconfiguration scenario:
"Dangerous ACLs exposing Group Policy Objects (GPOs) that are applied to privileged group members", such as Domain Admins, Enterprise Admins, or other Tier 0 accounts.

In this case, the root cause lies in excessive or poorly managed permissions set on GPO objects in Active Directory. These permissions are stored in two places:

- The LDAP object representing the GPO (in CN=Policies,CN=System,...)
- The corresponding SYSVOL folder that stores the actual GPO scripts and policies

When any user or group has write access (GpoEdit, Write, GenericWrite, WriteDACL, etc.) to one of these layers, they can:

- Modify GPO settings to run malicious scripts
- Apply registry modifications
- Alter login/logoff behavior for privileged users

## üîÅ Common Root Causes

* GPOs linked to privileged user scopes (e.g., OU containing Domain Admins) are not secured and allow modification by non-Tier 0 users.
* Legacy delegation models that granted permissions to groups like ITSupport, HelpDesk, or even Authenticated Users.
* ACL drift: Permissions in LDAP are not kept in sync with permissions in the SYSVOL folder.
* Inherited permissions allow downstream access unintentionally.
* Azure AD Connect service accounts or other delegated identities are over-permissioned for convenience.

## üõ°Ô∏è Consequences

If a GPO applied to a privileged group is compromised, an attacker can:
- Run code as a Domain Admin at logon
- Maintain persistence by continuously reapplying malicious settings
- Pivot to other systems with higher privileges

# üõ†Ô∏è 3. How an Attacker Exploits This Vulnerability
Real-world example: taking control of a GPO applied to Domain Admins.

Exploitation techniques: GPO editing, script injection, privilege escalation via logon scripts.

Common tools:

BloodHound for control path mapping.

PingCastle to identify dangerous ACLs and vulnerable GPOs.

# üß∞ 4. Detection
Detection methods:

Mapping with BloodHound (e.g., Find-GPOPaths).

Auditing with PingCastle (control paths tab).

PowerShell:

Get-GPPermissions

Get-Acl with ACE filtering (e.g., WriteDacl, GenericAll).

# üßº 5. Remediation
Recommended actions:

Review and harden permissions using gpmc.msc.

Ensure ACL synchronization between LDAP and SYSVOL for GPOs.

Remove dangerous ACEs (e.g., Authenticated Users with Edit settings).

Microsoft patches:

KB5008383 (fixes some computer account control paths).

Azure AD Connect specifics:

Use Set-ADSyncRestrictedPermissions from AdSyncConfig.psm1 module.

# üîí 6. Accepting the Risk: Edge Cases
When some delegations are functionally required (e.g., support, automation).

Risk mitigation requirements:

Treat delegated accounts as privileged.

Protect them via adminSDHolder.

Avoid permissive inheritance and minimize ACE exposure.

# üìé 7. Useful Links / Appendices
Azure AD Connect download: official link

Microsoft documentation on Set-ADSyncRestrictedPermissions

PowerShell command references:

Detection: Get-GPPermissions, Get-ADObject, Get-Acl

Remediation: Set-GPPermissions, Remove-ADPermission