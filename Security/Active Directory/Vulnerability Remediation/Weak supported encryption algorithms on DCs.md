# Weak supported encryption algorithms on DCs 
üóìÔ∏è Published: 2025-05-05


This article is based on updates introduced in the **January 2025 Cumulative Update** for Windows Server 2016 and newer.  
These updates added **new fields to Kerberos events 4768 and 4769** on Domain Controllers, providing greater visibility into how tickets are issued and encrypted.

These enhancements now make it possible to centrally identify:

- The **session key encryption type** for both TGTs and service tickets  
- The **encryption types advertised by Kerberos clients** (from AS-REQ and TGS-REQ)  
- The **available encryption keys** on the accounts involved (to detect missing AES support)  

### üîç Example: Kerberos TGT Request (`4768` Event)

![](assets/Weak%20supported%20encryption%20algorithms%20on%20DCs/2025-05-05-21-35-56.png)

| **Section**             | **Field**                            | **Description**                                                                                                                                    |
| ----------------------- | ------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Account Information** | `Account Name`                       | The account requesting the TGT (user or computer account).                                                                                         |
|                         | `MSDS-SupportedEncryptionTypes`      | If not set on the account, the **DefaultDomainSupportedEncTypes** value on the **authenticating DC** will be used.                                 |
|                         | `Available Keys`                     | If AES-SHA1 is not listed here, the account‚Äôs password has likely **not been changed since AES support was introduced** in the domain.             |
| **Service Information** | `Service Name`                       | For TGT requests, this is always `krbtgt`.                                                                                                         |
|                         | `MSDS-SupportedEncryptionTypes`      | Determined by the **domain**, not the attribute on the krbtgt object.                                                                              |
|                         | `Available Keys`                     | Same logic as above: missing AES-SHA1 here means the **krbtgt password hasn‚Äôt been reset since AES was enabled**.                                  |
| **Network Information** | `Client Address`                     | IP address of the Kerberos client requesting the TGT.                                                                                              |
|                         | `Advertized Etypes`                  | The encryption types the client claims it **supports** in the AS-REQ. This is key to detecting RC4-dependent clients.                              |
| **Additional Info**     | `Error Code`                         | `0x0` indicates success. Other values indicate failure; refer to Microsoft‚Äôs list of Kerberos error codes.                                         |
|                         | `Ticket Encryption Type`             | **Prior to Jan 2025:** showed the encryption of the session key. <br> **After Jan 2025:** shows the encryption of the **TGT itself** (KDC to KDC). |
|                         | `Session Encryption Type`            | Encryption used for the **session key shared with the client**. This value **must match what the client supports** (based on `Advertized Etypes`). |
|                         | `Pre-Authentication Encryption Type` | Indicates which encryption type was used for pre-auth (if required). Should match the **strongest advertised encryption** by the client.           |


### üîç Example: Kerberos Service Ticket Request (`4769` Event)

![](assets/Weak%20supported%20encryption%20algorithms%20on%20DCs/2025-05-05-21-36-33.png)

| **Section**             | **Field**                       | **Description**                                                                                                                                               |
| ----------------------- | ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Account Information** | `Account Name`                  | The account requesting the **Service Ticket** (TGS-REQ).                                                                                                      |
|                         | `MSDS-SupportedEncryptionTypes` | N/A ‚Äì The value on the **requesting account** does **not influence** the encryption type used in the service ticket.                                          |
| **Service Information** | `Service Name`                  | The **target account** of the ticket request (usually a service with an SPN).                                                                                 |
|                         | `MSDS-SupportedEncryptionTypes` | The **KDC selects the strongest encryption** supported by the target account‚Äôs configured values.                                                             |
|                         | `Available Keys`                | If **AES-SHA1 is missing**, the service account‚Äôs password has not been changed since AES support was introduced.                                             |
| **Network Information** | `Client Address`                | IP address of the Kerberos client that requested the service ticket.                                                                                          |
|                         | `Advertized Etypes`             | The encryption types the **client says it supports** (in the TGS-REQ packet). Helps detect legacy/RC4-only clients.                                           |
| **Additional Info**     | `Ticket Encryption Type`        | Encryption algorithm the KDC **used for the service ticket**. If the target account lacks encryption config, KDC will **default to RC4**.                     |
|                         | `Session Encryption Type`       | Encryption algorithm used to **protect the session key** shared between the client and service. Defaults to AES if advertised and supported (since Nov 2022). |

---

### üîê Kerberos Encryption Algorithms on Domain Controllers

Kerberos is the default authentication protocol in Active Directory environments, handling identity verification by issuing and validating tickets.

Each Kerberos exchange includes:
- A **ticket**, encrypted with a key known to the KDC and the target service
- A **session key**, encrypted with an algorithm the client supports

Over time, some encryption types (DES, RC4) have become obsolete and insecure. Microsoft now recommends using only AES-based encryption.

| Encryption Type                        | Hex Value       | Status                                 |
|----------------------------------------|------------------|----------------------------------------|
| DES-CBC-CRC / DES-CBC-MD5              | `0x1` / `0x2`   | ‚ùå Insecure and deprecated              |
| RC4-HMAC                               | `0x4`           | ‚ö†Ô∏è Weak, legacy compatibility           |
| AES128-CTS-HMAC-SHA1-96                | `0x8`           | ‚úÖ Strong (available since 2008)        |
| AES256-CTS-HMAC-SHA1-96                | `0x10`          | ‚úÖ Strong (available since 2008)        |
| AES*-CTS-HMAC-SHA2-\* (optional)       | `0x11` / `0x12` | ‚úÖ Strongest, supported in modern builds |
| `0x20`+                                | ‚Äî               | Reserved / undocumented                |


üîê Microsoft recommends disabling DES and RC4, and ensuring AES is used exclusively wherever possible. This reduces the risk of ticket spoofing, key cracking, and "Kerberoasting" attacks.

---

### üìé Understanding msDS-SupportedEncryptionTypes

The msDS-SupportedEncryptionTypes attribute is a bitmask stored on computer, user, and trust objects in Active Directory. It defines which encryption types the object can use to accept or request Kerberos tickets.
This is not a list of what the KDC will issue, but rather what the object is capable of using. For service accounts, it directly impacts the encryption of service tickets.

When not set, systems fall back to default behavior:
On DCs, the KDC defaults to RC4, unless AES is configured
On clients, the encryption used depends on local policy/GPO settings

Here are some examples of msDS-SupportedEncryptionTypes values and what they mean:

| Value (Hex) | Meaning                          | Interpretation                     |
| ----------- | -------------------------------- | ---------------------------------- |
| `0x18`      | AES128 (`0x8`) + AES256 (`0x10`) | ‚úÖ Strong AES only                  |
| `0x1C`      | AES128 + AES256 + `0x4` (RC4)    | ‚ö†Ô∏è AES preferred, but RC4 allowed  |
| `0x1F`      | AES128 + AES256 + RC4 + DES      | ‚ùå Weak & legacy algorithms enabled |

üí° Best practice:

Apply this attribute via GPO using:

Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options >
‚ÄúNetwork security: Configure encryption types allowed for Kerberos‚Äù

This ensures consistent enforcement across DCs, domain-joined systems, and automatically updates the attribute in AD.

---

## üßæ Phase 1 ‚Äì Reporting on Kerberos Encryption Configuration of Domain Controllers

The first step in securing Kerberos encryption across an Active Directory forest is to assess which encryption algorithms are currently enabled on each Domain Controller. This information is stored in the msDS-SupportedEncryptionTypes attribute of each DC‚Äôs computer object.

The PowerShell script below performs this task by:
* Enumerating all domains in the forest
* Querying each Domain Controller's computer object
* Decoding the msDS-SupportedEncryptionTypes bitmask using a predefined mapping
* Flagging each DC with a vulnerability level, based on its encryption configuration :

| Level   | Condition                                     | Risk                             |
| ------- | --------------------------------------------- | -------------------------------- |
| Level 2 | **DES** algorithms are enabled (`0x1`, `0x2`) | ‚ùå Cryptographically broken       |
| Level 3 | **AES is missing** (no `0x8` or `0x10`)       | ‚ö†Ô∏è Weak and legacy compatibility |
| Level 4 | **RC4** is still allowed (`0x4`)              | ‚ö†Ô∏è Susceptible to Kerberoasting  |
| OK      | Only AES (`0x8`/`0x10`) is present            | ‚úÖ Secure                         |



This provides a forest-wide visibility of DC encryption posture, enabling administrators to identify and prioritize misconfigured or non-compliant systems.

Below is the script used to perform this forest-wide assessment:

‚úÖ Prerequisites :

Before running the Kerberos encryption audit script across your forest, make sure the following prerequisites are met:

- PowerShell Environment : Windows PowerShell 5.1 or PowerShell 7+
- Run from a domain-joined machine (management server, workstation, or Domain Controller)
- Required Modules : Active Directory PowerShell module
- Permissions : The script must be executed by an account that has read access to all domains and DC computer objects
- Network Requirements : The machine running the script must be able to resolve and connect to all Domain Controllers via: DNS, LDAP / RPC (default ports: 389, 135)
- Firewall rules must allow LDAP/LDAPs queries and remote AD object resolution across domains


```powershell
# Define encryption algorithm bitmask values
$EncryptionTypesMap = @{
    "DES-CBC-CRC"                          = 0x1
    "DES-CBC-MD5"                          = 0x2
    "RC4-HMAC"                             = 0x4
    "AES128-CTS-HMAC-SHA1-96"              = 0x8
    "AES256-CTS-HMAC-SHA1-96"              = 0x10
    "AES256-CTS-HMAC-SHA1-96-SK (AES-SK)"  = 0x20
}

# Initialize result array
$results = @()

# Get all domains in the forest
$forest = [System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()
$domains = $forest.Domains

foreach ($domain in $domains) {
    Write-Host "`nüîç Domain: $($domain.Name)" -ForegroundColor Cyan

    # Connect to domain context
    $domainContext = New-Object System.DirectoryServices.ActiveDirectory.DirectoryContext('Domain', $domain.Name)
    $domainDCs = [System.DirectoryServices.ActiveDirectory.DomainController]::FindAll($domainContext)

    foreach ($dc in $domainDCs) {
        $dcName = $dc.Name.Split(".")[0]  # NetBIOS name
        try {
            # Get the msDS-SupportedEncryptionTypes attribute
            $adComputer = Get-ADComputer -Server $domain.Name -Identity $dcName -Properties msDS-SupportedEncryptionTypes
            $encTypes = $adComputer.'msDS-SupportedEncryptionTypes'

            if (-not $encTypes) {
                $enabledAlgos = "Not Set (defaults to RC4)"
                $level = "Level 4 (RC4 fallback)"
            } else {
                $enabledAlgosList = (
                    $EncryptionTypesMap.GetEnumerator() | Where-Object {
                        ($encTypes -band $_.Value)
                    } | ForEach-Object {
                        $_.Key
                    }
                )
                $enabledAlgos = $enabledAlgosList -join ', '

                # Determine vulnerability level
                if ($enabledAlgosList -contains "DES-CBC-CRC" -or $enabledAlgosList -contains "DES-CBC-MD5") {
                    $level = "Level 2 (DES enabled)"
                } elseif (-not ($enabledAlgosList -contains "AES128-CTS-HMAC-SHA1-96" -or $enabledAlgosList -contains "AES256-CTS-HMAC-SHA1-96")) {
                    $level = "Level 3 (no AES)"
                } elseif ($enabledAlgosList -contains "RC4-HMAC") {
                    $level = "Level 4 (RC4 enabled)"
                } else {
                    $level = "OK"
                }
            }

            # Add to results
            $results += [PSCustomObject]@{
                Domain                   = $domain.Name
                DCName                   = $dcName
                FQDN                     = $dc.Name
                SupportedEncryptionTypes = if ($encTypes) { "0x{0:X}" -f $encTypes } else { "Not Set" }
                EnabledAlgorithms        = $enabledAlgos
                VulnerabilityLevel       = $level
            }
        } catch {
            Write-Warning "‚ùå Error for $dcName in $($domain.Name): $_"
        }
    }
}

# Output results
$results | Format-Table -AutoSize
# Optional: export to CSV
# $results | Export-Csv "Kerberos_Encryption_Forest_Audit.csv" -NoTypeInformation
```

Example :

![](assets/Weak%20supported%20encryption%20algorithms%20on%20DCs/2025-05-05-14-52-18.png)


---

## üßæ Phase 2 ‚Äì Analyzing Kerberos Ticket Usage Across Domain Controllers

Now that we‚Äôve identified the encryption types configured on each Domain Controller via the `msDS-SupportedEncryptionTypes` attribute, the next step is to determine **what encryption is actually being used in production**.

Each time a Kerberos ticket is issued‚Äîeither a Ticket Granting Ticket (TGT) or a Service Ticket (TGS)‚Äîan event is logged in the **Security event log** of the issuing Domain Controller:

- **Event ID 4768** ‚Äì TGT issued (Authentication Service / AS-REQ)
- **Event ID 4769** ‚Äì Service Ticket issued (Service Ticket / TGS-REQ)

> üì¢ **Important (January 2025 Update)**:  
> These events now include updated fields that distinguish between:
> - `Ticket Encryption Type`: algorithm used to encrypt the ticket itself (e.g. the TGT or TGS)
> - `Session Encryption Type`: algorithm used for the session key shared with the client
> - `Advertised Etypes`: list of encryption types the client claims to support

By collecting and analyzing these logs across all DCs, administrators can:

- üîé Identify legacy systems still requesting **weak encryption** (e.g., DES or RC4)
- ‚úÖ Confirm whether **only AES-based encryption** is used in live environments
- ‚ö†Ô∏è Pinpoint clients or services that may **break** if legacy encryption is disabled
- üéØ Justify GPO hardening actions with real-world evidence

This **usage-based analysis** is essential before applying restrictive encryption policies, especially in large or mixed environments with older systems.

---

### üß± Prerequisites ‚Äì Kerberos Auditing

To capture these events on each Domain Controller, ensure **Kerberos auditing is enabled**.

Enable the following audit subcategories via Group Policy or Advanced Audit Policy:

- `Audit Kerberos Authentication Service` ‚Üí for TGT issuance (**Event ID 4768**)
- `Audit Kerberos Service Ticket Operations` ‚Üí for TGS issuance (**Event ID 4769**)

You can verify auditing is active by running:

```powershell
AuditPol /get /subcategory:"Kerberos Authentication Service"
AuditPol /get /subcategory:"Kerberos Service Ticket Operations"
```

### üìã Kerberos Event Reference Summary :

| Event ID | Description                        | Triggered When...                         | What to Check                                                       |
| -------- | ---------------------------------- | ----------------------------------------- | ------------------------------------------------------------------- |
| `4768`   | Kerberos Authentication Service    | A user or computer authenticates (AS-REQ) | Look at `SessionEncryptionType` and `TicketEncryptionType` for TGTs |
| `4769`   | Kerberos Service Ticket Operations | A service ticket is issued (TGS-REQ)      | Same fields ‚Äî used for service ticket encryption                    |

üß† The field TicketEncryptionType is used by auditors and security tools to determine whether weak encryption (e.g. RC4, DES) is still being issued by your KDCs.


* Powershell Script :
üí° Adapt the script with a list of DC that your want to query + change the timeline according to your needs

```powershell
# Mapping for Kerberos encryption types from 4768/4769 logs
$encMap = @{
    0x1  = "DES-CBC-CRC"
    0x3  = "DES-CBC-MD5"
    0x11 = "AES128-CTS-HMAC-SHA1-96"
    0x12 = "AES256-CTS-HMAC-SHA1-96"
    0x17 = "RC4-HMAC"
    0x18 = "RC4-HMAC-EXP"
}

# Domain Controllers to query
$DCList = @(
    "MyDC1.contoso.com",
    "MyDC2.child.contoso.com"
)

# Results containers
$results = @()
$weakTickets = @()

foreach ($dc in $DCList) {
    Write-Host "`nüì° Querying $dc..." -ForegroundColor Yellow

    try {
        $events = Get-WinEvent -ComputerName $dc -FilterHashtable @{
            LogName   = 'Security'
            Id        = @(4768, 4769)
            StartTime = (Get-Date).AddHours(-1)
        } -MaxEvents 1000 -ErrorAction Stop

        foreach ($event in $events) {
            $xml = [xml]$event.ToXml()
            $data = $xml.Event.EventData.Data

            function Get-FieldValue($name) {
                ($data | Where-Object { $_.Name -eq $name }).'#text'
            }

            $ticketEnc    = Get-FieldValue "TicketEncryptionType"
            $sessionEnc   = Get-FieldValue "SessionKeyEncryptionType"
            $etypesRaw    = Get-FieldValue "ClientAdvertizedEncryptionTypes"
            $etypesList   = if ($etypesRaw) { $etypesRaw -split '\s+' } else { @() }
            $etypesJoin   = if ($etypesList.Count -gt 0) { $etypesList -join ', ' } else { "N/A" }

            $targetUser   = Get-FieldValue "TargetUserName"
            $serviceName  = Get-FieldValue "ServiceName"
            $ip           = Get-FieldValue "IpAddress"

            if ($ticketEnc) {
                $etype = [int]$ticketEnc
                $etypeHex = '0x{0:X}' -f $etype

                if ($etype -eq 0xFFFFFFFF) {
                    $etypeLabel = "Unknown (0xFFFFFFFF)"
                    $status = "Failure"
                } elseif ($encMap.ContainsKey($etype)) {
                    $etypeLabel = $encMap[$etype]
                    $status = "Success"
                } else {
                    $etypeLabel = "Unknown ($etypeHex)"
                    $status = "Success"
                }

                # Correct handling of session encryption mapping
                if ($sessionEnc) {
                    $sessionType = [int]$sessionEnc
                    if ($encMap.ContainsKey($sessionType)) {
                        $sessionLabel = $encMap[$sessionType]
                    } else {
                        $sessionLabel = "Unknown (0x{0:X})" -f $sessionType
                    }
                } else {
                    $sessionLabel = "N/A"
                }

                # Add to global results
                $results += [PSCustomObject]@{
                    DC                  = $dc
                    Time                = $event.TimeCreated
                    EventID             = $event.Id
                    TicketEncryption    = $etypeLabel
                    SessionEncryption   = $sessionLabel
                    AdvertisedEtypes    = $etypesJoin
                    TargetUser          = $targetUser
                    Service             = $serviceName
                    IpAddress           = $ip
                    Status              = $status
                }

                # Detect weak encryption (DES, RC4, etc)
                if ($etype -in 0x1, 0x3, 0x17, 0x18) {
                    $weakTickets += [PSCustomObject]@{
                        DC                 = $dc
                        Time              = $event.TimeCreated
                        Encryption         = $etypeLabel
                        SessionEncryption  = $sessionLabel
                        AdvertisedEtypes   = $etypesJoin
                        TargetUser         = $targetUser
                        Service            = $serviceName
                        IpAddress          = $ip
                        Status             = $status
                    }
                }
            }
        }
    } catch {
        Write-Warning ("‚ùå Failed to read events from {0}: {1}" -f $dc, $_)
    }
}

# Summary output
$summary = $results | Group-Object DC, TicketEncryption, Status | ForEach-Object {
    $parts = $_.Name -split ',\s*'
    [PSCustomObject]@{
        DCName           = $parts[0]
        TicketEncryption = $parts[1]
        Status           = $parts[2]
        Count            = $_.Count
    }
}

Write-Host "`n‚úÖ Summary of encryption types used:" -ForegroundColor Cyan
$summary | Format-Table -AutoSize

# Display weak encryption ticket details
if ($weakTickets.Count -gt 0) {
    Write-Host "`n‚ö†Ô∏è  Weak encryption tickets detected (DES, RC4, etc):" -ForegroundColor Red
    $weakTickets | Format-Table -AutoSize
}

# Optional export
# $results | Export-Csv "Kerberos_Ticket_Details.csv" -NoTypeInformation
# $weakTickets | Export-Csv "Kerberos_Weak_Tickets.csv" -NoTypeInformation
# $summary | Export-Csv "Kerberos_Encryption_Summary.csv" -NoTypeInformation
```

Example : 

![](assets/Weak%20supported%20encryption%20algorithms%20on%20DCs/2025-05-05-22-22-35.png)

---

## üßæ Phase 3 ‚Äì Understanding and Acting on Results to Remediate Weak Kerberos Encryption

### üîç Objective of This Phase

Now that you have visibility on:

- The **Kerberos encryption types supported** by each Domain Controller (`msDS-SupportedEncryptionTypes`)
- The **Kerberos encryption types actually used** for issued tickets (from Event IDs `4768` and `4769`)

You can **identify non-compliant systems** and **take targeted remediation actions** to enforce modern encryption (AES) and phase out deprecated or weak algorithms like RC4 and DES.

---

### ‚öôÔ∏è How the Script Works (Recap)

The PowerShell script performs the following:

1. **Parses 4768 & 4769 events** from the Security logs of selected DCs (manual `$DCList`).
2. Extracts key fields:
   - `TicketEncryptionType` (encryption of the ticket itself)
   - `SessionKeyEncryptionType` (used between client and service/DC)
   - `ClientAdvertizedEncryptionTypes` (client's declared supported algorithms)
3. Classifies encryption usage:
   - AES ‚Üí ‚úÖ OK
   - RC4 / DES ‚Üí ‚ö†Ô∏è Legacy
   - `0xFFFFFFFF` ‚Üí ‚ùå Kerberos failure
4. Aggregates results:
   - Summary table: encryption algorithms used per DC
   - Weak usage table: clients/tickets using legacy crypto

---

### üß† How to Interpret the Results

Each row in the output provides the following:

| Column               | Meaning                                                                 |
|----------------------|-------------------------------------------------------------------------|
| `TicketEncryption`   | What the **KDC used to encrypt** the ticket. This must be AES ideally. |
| `SessionEncryption`  | What was used for the session key. Reflects what the client negotiated.|
| `AdvertisedEtypes`   | What the client supports. Key to identifying RC4-only devices.          |
| `TargetUser`, `Service` | Shows which account or machine made the request.                    |

#### üö© What to Look For

- If `TicketEncryption = RC4-HMAC` ‚Üí The **target service account allows RC4**.
- If `SessionEncryption = RC4-HMAC` ‚Üí The **client device does not support AES**.
- If `AdvertisedEtypes` only includes RC4 / DES ‚Üí The device is **RC4-only**.

---

### üõ† Recommended Remediation Actions

#### ‚úÖ 1. Fix Clients Advertising Only RC4

Clients that negotiate RC4 will show:

- `SessionEncryption = RC4-HMAC`
- `AdvertisedEtypes = RC4-HMAC...`

**Action:** Apply a GPO or local policy to **enable AES** on the client:

Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options >
"Network security: Configure encryption types allowed for Kerberos"

Recommended setting: `AES128`, `AES256`, `Future encryption types`

---

#### ‚úÖ 2. Fix Service Accounts (SPN-enabled) Defaulting to RC4

If you see:

- `TicketEncryption = RC4-HMAC`

**Action:** Set `msDS-SupportedEncryptionTypes` on the service account to AES-only (0x18 or 0x1C if RC4 must temporarily remain):

```powershell
Set-ADUser -Identity svcAccount -Replace @{msDS-SupportedEncryptionTypes = 24}
```

‚ö†Ô∏è Important: Reset the password after setting this attribute to regenerate AES keys.

#### ‚úÖ 3. Fix Domain Controllers Defaulting to RC4

In Phase 1, if a DC shows:

msDS-SupportedEncryptionTypes = Not Set or 0x4

Action: Apply a GPO to all Domain Controllers (e.g., Default Domain Controller Policy):

Same path as above:

Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options >
"Network security: Configure encryption types allowed for Kerberos"
Select: AES128 + AES256 + Future types (and optionally RC4 during transition)

### üß™ Testing and Validation

After applying changes:

1. Purge existing Kerberos tickets:
klist purge

2. Reboot the device (if local registry was changed)

3. Wait for GPOs to apply and for AD replication

4. Re-run the audit script

‚úÖ You should now see:

SessionEncryption = AES...

TicketEncryption = AES...

RC4 and DES removed from usage.

---

Sources : 
https://techcommunity.microsoft.com/blog/coreinfrastructureandsecurityblog/decrypting-the-selection-of-supported-kerberos-encryption-types/1628797
https://techcommunity.microsoft.com/blog/coreinfrastructureandsecurityblog/active-directory-hardening-series---part-4-%E2%80%93-enforcing-aes-for-kerberos/4114965
https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4769
https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4768

